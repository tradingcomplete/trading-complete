# åˆ©ç›Šç‡æ©Ÿèƒ½ è¦ä»¶å®šç¾©æ›¸
## å®Œå…¨ç‰ˆ v2.1ï¼ˆå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆå®Œäº†ï¼‰

**ä½œæˆæ—¥**: 2026-02-01  
**å®Œäº†æ—¥**: 2026-02-02  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œå…¨å®Œäº†

---

## ğŸ“‹ æ©Ÿèƒ½æ¦‚è¦

### 2ç¨®é¡ã®åˆ©ç›Šç‡

| # | åç§° | è¨ˆç®—å¼ | è¡¨ç¤ºå ´æ‰€ |
|---|------|--------|----------|
| 1 | å¹´åº¦åˆ¥åˆ©ç›Šç‡ | å¹´é–“åˆ©ç›Š Ã· å¹´åˆå£åº§æ®‹é«˜ Ã— 100 | åˆ†æã‚¿ãƒ–ã€Œç·åˆçµ±è¨ˆã€ |
| 2 | å…¨æœŸé–“åˆ©ç›Šç‡ | å…¨æœŸé–“åˆ©ç›Š Ã· æŠ•å…¥è³‡é‡‘ Ã— 100 | åæ”¯ç®¡ç†ã‚¿ãƒ–ã€Œå…¥å‡ºé‡‘ç®¡ç†ã€ |

---

## âœ… ãƒ†ã‚¹ãƒˆçµæœ

### å¹´åº¦åˆ¥åˆ©ç›Šç‡

| å¹´åº¦ | å¹´åˆå£åº§æ®‹é«˜ | å¹´é–“åˆ©ç›Š | åˆ©ç›Šç‡ |
|------|-------------|----------|--------|
| 2025å¹´ | Â¥110,000 | Â¥4,008,637 | **3644.2%** âœ… |
| 2026å¹´ | Â¥1,000,000 | Â¥35,365 | **3.5%** âœ… |

### å…¨æœŸé–“åˆ©ç›Šç‡

| æŠ•å…¥è³‡é‡‘ | å…¨æœŸé–“åˆ©ç›Š | åˆ©ç›Šç‡ |
|----------|-----------|--------|
| Â¥110,000 | Â¥4,044,002 | **3676.4%** âœ… |

---

## ğŸ—ºï¸ å®Ÿè£…å®Œäº†ä¸€è¦§ï¼ˆMODULES.mdæº–æ‹ ï¼‰

### Phase 1: ãƒ‡ãƒ¼ã‚¿å±¤ âœ…

| # | ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ | çŠ¶æ…‹ |
|---|----------|------|------|
| 1-1 | SettingsModule.js | å¹´åˆå£åº§æ®‹é«˜APIè¿½åŠ  | âœ… å®Œäº† |
| 1-2 | SyncModule.js | yearStartBalancesåŒæœŸè¿½åŠ  | âœ… å®Œäº† |
| 1-3 | Supabase SQL | year_start_balancesã‚«ãƒ©ãƒ è¿½åŠ  | âœ… å®Œäº† |

### Phase 2: UIå±¤ âœ…

| # | ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ | çŠ¶æ…‹ |
|---|----------|------|------|
| 2-1 | year-start-balance-ui.js | å¹´åˆå£åº§æ®‹é«˜è¨­å®šUIï¼ˆæ–°è¦ä½œæˆï¼‰ | âœ… å®Œäº† |
| 2-2 | capital-ui.js | å…¨æœŸé–“åˆ©ç›Šç‡è¡¨ç¤ºè¿½åŠ  | âœ… å®Œäº† |
| 2-3 | StatisticsModule.js | åˆ†æã‚¿ãƒ–åˆ©ç›Šç‡åˆæœŸåŒ– | âœ… å®Œäº† |
| 2-4 | index.html | scriptã‚¿ã‚°è¿½åŠ ãƒ»é–¢æ•°å‰Šé™¤ | âœ… å®Œäº† |

### Phase 3: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ âœ…

| # | ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ | çŠ¶æ…‹ |
|---|----------|------|------|
| 3-1 | Supabase_ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ .md | year_start_balancesè¿½åŠ  | âœ… å®Œäº† |
| 3-2 | MODULES.md | year-start-balance-ui.jsè¿½åŠ  | âœ… å®Œäº† |

---

## ğŸ“‚ MODULES.mdæº–æ‹  æœ€çµ‚æ§‹æˆ

```
js/part5/ï¼ˆè¨­å®šã‚¿ãƒ–UIï¼‰
â”œâ”€ broker-ui.js              âœ… æ—¢å­˜
â”œâ”€ favorite-pair-ui.js       âœ… æ—¢å­˜
â”œâ”€ capital-ui.js             âœ… å…¨æœŸé–“åˆ©ç›Šç‡è¿½åŠ 
â””â”€ year-start-balance-ui.js  âœ… æ–°è¦è¿½åŠ 

js/part8_modules/ï¼ˆçµ±è¨ˆï¼‰
â””â”€ StatisticsModule.js       âœ… åˆ©ç›Šç‡åˆæœŸåŒ–è¿½åŠ 

js/part5_modules/ï¼ˆè¨­å®šï¼‰
â””â”€ SettingsModule.js         âœ… å¹´åˆå£åº§æ®‹é«˜APIè¿½åŠ 

js/ï¼ˆåŒæœŸï¼‰
â””â”€ SyncModule.js             âœ… yearStartBalancesåŒæœŸè¿½åŠ 
```

---

## ğŸ”§ è¿½åŠ ã•ã‚ŒãŸAPI

### SettingsModule.js
```javascript
getYearStartBalance(year)              // å¹´åˆå£åº§æ®‹é«˜å–å¾—
setYearStartBalance(year, amount)      // å¹´åˆå£åº§æ®‹é«˜è¨­å®š
getAllYearStartBalances()              // å…¨å¹´åº¦å–å¾—
calculatePreviousYearEndBalance(year)  // å‰å¹´æœ«æ®‹é«˜è¨ˆç®—
```

### capital-ui.js
```javascript
updateTotalProfitRate()                // å…¨æœŸé–“åˆ©ç›Šç‡è¨ˆç®—ãƒ»è¡¨ç¤º
```

### year-start-balance-ui.js
```javascript
initYearStartBalanceUI()               // UIåˆæœŸåŒ–
addYearStartBalanceRowUI(year, amount) // è¡Œè¿½åŠ 
addYearStartBalanceRow()               // å¹´åº¦è¿½åŠ 
saveYearStartBalance(year, value)      // ä¿å­˜
calculateFromPrevYear(year, rowElement)// å‰å¹´æœ«ã‹ã‚‰è¨ˆç®—
removeYearStartBalanceRow(year, rowElement) // å‰Šé™¤
```

---

## ğŸ“¡ EventBusé€£æº

### ç™ºç«ã‚¤ãƒ™ãƒ³ãƒˆ
```javascript
'settings:yearStartBalanceChanged'     // å¹´åˆå£åº§æ®‹é«˜å¤‰æ›´æ™‚
```

### ç›£è¦–ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆStatisticsModule.jsï¼‰
```javascript
'settings:initialized'                 // SettingsModuleåˆæœŸåŒ–å®Œäº†
'settings:yearStartBalanceChanged'     // å¹´åˆå£åº§æ®‹é«˜å¤‰æ›´
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### LocalStorage
```javascript
// ã‚­ãƒ¼: yearStartBalances
{
    "2025": 110000,
    "2026": 1000000
}
```

### Supabase
```sql
-- user_settingsãƒ†ãƒ¼ãƒ–ãƒ«
year_start_balances JSONB DEFAULT '{}'
```

---

## âœ… å‹•ä½œç¢ºèªæ¸ˆã¿é …ç›®

| # | ãƒ†ã‚¹ãƒˆé …ç›® | çµæœ |
|---|-----------|------|
| 1 | å¹´åˆå£åº§æ®‹é«˜è¨­å®šãƒ»ä¿å­˜ | âœ… |
| 2 | å¹´åˆå£åº§æ®‹é«˜ãƒªãƒ­ãƒ¼ãƒ‰å¾Œå¾©å…ƒ | âœ… |
| 3 | åˆ†æã‚¿ãƒ–å¹´åº¦åˆ¥åˆ©ç›Šç‡è¡¨ç¤ºï¼ˆåˆæœŸåŒ–æ™‚ï¼‰ | âœ… |
| 4 | åˆ†æã‚¿ãƒ–å¹´åº¦åˆ¥åˆ©ç›Šç‡è¡¨ç¤ºï¼ˆå¹´åº¦åˆ‡æ›¿æ™‚ï¼‰ | âœ… |
| 5 | åæ”¯ç®¡ç†ã‚¿ãƒ–å…¨æœŸé–“åˆ©ç›Šç‡è¡¨ç¤º | âœ… |
| 6 | å…¥å‡ºé‡‘è¿½åŠ /å‰Šé™¤æ™‚ã®å…¨æœŸé–“åˆ©ç›Šç‡æ›´æ–° | âœ… |
| 7 | SupabaseåŒæœŸï¼ˆä¿å­˜ï¼‰ | âœ… |
| 8 | SupabaseåŒæœŸï¼ˆå¾©å…ƒï¼‰ | âœ… |
| 9 | 2025å¹´åˆ©ç›Šç‡è¨ˆç®— | âœ… 3644.2% |
| 10 | 2026å¹´åˆ©ç›Šç‡è¨ˆç®— | âœ… 3.5% |

---

## ğŸ† æ•™è¨“ãƒ»ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. MODULES.mdæº–æ‹ ã‚’æœ€å„ªå…ˆ
- index.htmlã«ç›´æ¥é–¢æ•°ã‚’æ›¸ã‹ãªã„
- æ‹…å½“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«æ©Ÿèƒ½ã‚’è¿½åŠ 

### 2. UIé–¢é€£ã®é…ç½®ãƒ«ãƒ¼ãƒ«
```
Part 5ï¼ˆè¨­å®šã‚¿ãƒ–ï¼‰â†’ js/part5/*.js
Part 7ï¼ˆåæ”¯ç®¡ç†ï¼‰â†’ js/part5/capital-ui.js
Part 8ï¼ˆçµ±è¨ˆï¼‰â†’ js/part8_modules/StatisticsModule.js
```

### 3. åˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®æ³¨æ„
- DOMContentLoadedã‚’å¾…ã¤
- ä»–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åˆæœŸåŒ–å®Œäº†ã‚’EventBusã§å¾…ã¤

---

## ğŸ”„ ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å†…å®¹ |
|-----------|------|------|
| v1.0 | 2026-02-01 | åˆç‰ˆä½œæˆ |
| v1.1 | 2026-02-02 | ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã«å†ç·¨æˆ |
| v2.0 | 2026-02-02 | å…¨Phaseå®Œäº† |
| **v2.1** | **2026-02-02** | **ãƒ†ã‚¹ãƒˆçµæœè¿½è¨˜ãƒ»å®Œå…¨ç‰ˆ** |

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯REFERENCE.mdã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿*
